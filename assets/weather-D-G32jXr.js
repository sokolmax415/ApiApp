import"./modulepreload-polyfill-B5Qt9EMX.js";const p="df9facbcbc7370c8519f19b8c429a17e",f="http://api.weatherstack.com",e={cityInput:document.getElementById("cityInput"),searchBtn:document.getElementById("searchBtn"),currentLocationBtn:document.getElementById("currentLocationBtn"),weatherLoading:document.getElementById("weatherLoading"),weatherContent:document.getElementById("weatherContent"),weatherError:document.getElementById("weatherError"),errorMessage:document.getElementById("errorMessage"),cityName:document.getElementById("cityName"),country:document.getElementById("country"),date:document.getElementById("date"),temperature:document.getElementById("temperature"),feelsLike:document.getElementById("feelsLike"),weatherIcon:document.getElementById("weatherIcon"),weatherDescription:document.getElementById("weatherDescription"),humidity:document.getElementById("humidity"),windSpeed:document.getElementById("windSpeed"),pressure:document.getElementById("pressure"),visibility:document.getElementById("visibility")};document.addEventListener("DOMContentLoaded",E);function E(){c("Moscow"),e.searchBtn.addEventListener("click",s),e.cityInput.addEventListener("keypress",t=>{t.key==="Enter"&&s()}),e.currentLocationBtn&&e.currentLocationBtn.addEventListener("click",g)}function s(){const t=e.cityInput.value.trim();t?c(t):i("Пожалуйста, введите название города")}function g(){if(!navigator.geolocation){i("Геолокация не поддерживается вашим браузером");return}o(!0),e.currentLocationBtn.disabled=!0,navigator.geolocation.getCurrentPosition(t=>{const{latitude:n,longitude:r}=t.coords;B(n,r),e.currentLocationBtn.disabled=!1},t=>{i("Не удалось получить ваше местоположение"),e.currentLocationBtn.disabled=!1,o(!1)})}async function c(t="Moscow"){o(!0),u();try{const n=await d(t);l(n)}catch(n){i(n.message)}finally{o(!1)}}async function B(t,n){o(!0),u();try{const r=await d(`${t},${n}`);l(r)}catch(r){i(r.message)}finally{o(!1)}}async function d(t){const n=`${f}/current?access_key=${p}&query=${encodeURIComponent(t)}&units=m`,r=await fetch(n);if(!r.ok)throw new Error("Ошибка сети");const a=await r.json();if(a.error)throw new Error(a.error.info||"Ошибка получения данных");return a}function l(t){if(!t.current||!t.location)throw new Error("Неверный формат данных");const n=t.current,r=t.location;e.cityName.textContent=r.name,e.country.textContent=r.country,e.date.textContent=I(r.localtime),e.temperature.textContent=`${Math.round(n.temperature)}°C`,e.feelsLike.textContent=`${Math.round(n.feelslike)}°C`,n.weather_icons?.[0]&&(e.weatherIcon.src=n.weather_icons[0],e.weatherIcon.alt=n.weather_descriptions?.[0]||""),n.weather_descriptions&&(e.weatherDescription.textContent=n.weather_descriptions[0]),e.humidity.textContent=`${n.humidity}%`,e.windSpeed.textContent=`${n.wind_speed} км/ч`,e.pressure.textContent=`${n.pressure} гПа`,e.visibility.textContent=`${n.visibility} км`,C()}function I(t){if(!t)return"Дата не доступна";try{const[n,r]=t.split(" "),[a,y,h]=n.split("-"),[m,w]=r.split(":");return new Date(a,y-1,h,m,w).toLocaleDateString("ru-RU",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return t}}function o(t){if(e.weatherLoading.style.display=t?"block":"none",e.weatherContent.style.display=t?"none":"block",e.weatherError.style.display="none",e.searchBtn){e.searchBtn.disabled=t;const n=e.searchBtn.querySelector(".btn-text"),r=e.searchBtn.querySelector(".btn-spinner");n&&(n.style.display=t?"none":"block"),r&&(r.style.display=t?"block":"none")}}function C(){e.weatherContent.style.display="block",e.weatherError.style.display="none"}function i(t){e.weatherContent.style.display="none",e.weatherLoading.style.display="none",e.weatherError.style.display="block",e.errorMessage.textContent=t}function u(){e.weatherError.style.display="none"}window.loadWeather=c;
